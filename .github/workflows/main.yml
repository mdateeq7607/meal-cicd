#name: "build pipeline for web release"
#
#on:
#  push:
#    branches:
#      - main
#
#jobs:
#  build:
#    runs-on: ubuntu-latest
#    steps:
#      - uses: actions/checkout@v2
#      - uses: actions/setup-java@v1
#        with:
#          java-version: '12.x'
#      - uses: subosito/flutter-action@v2
#        with:
#          channel: 'stable'
#      - run: flutter pub get
#      - run: flutter build web
#
#      # copy file for netlify.toml
#      - name: Copy build settings to build folder
#        run: cp netlify.toml build/web/
#
#      # deploy application to netlify
#      - name: Deploy production to Netlify
#        uses: South-Paw/action-netlify-deploy@v1.2.0
#        with:
#          github-token: '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'
#          netlify-auth-token: ${{ secrets.NETLIFY_AUTH_TOKEN }}
#          netlify-site-id: ${{ secrets.NETLIFY_SITE_ID }}
#          build-dir: './build/web'
#          comment-on-commit: true
name: Build and Release
'on':
  push:
    branches:
      - main
      -
jobs:
  build:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1
      - name: set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 1.8
      - name: build release
        run: ./gradlew assembleRelease
      - name: upload artifact to Firebase App Distribution
        uses: wzieba/Firebase-Distribution-Github-Action@v1
        with:
          appId: ${{secrets.FIREBASE_APP_ID}}
          serviceCredentialsFileContent: ${{ secrets.CREDENTIAL_FILE_CONTENT }}
          groups: testers
          file: app/build/outputs/apk/release/app-release-unsigned.apk